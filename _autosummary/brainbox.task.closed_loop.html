

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>brainbox.task.closed_loop &mdash; IBL Library  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="brainbox.task.passive" href="brainbox.task.passive.html" />
    <link rel="prev" title="brainbox.task" href="brainbox.task.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> IBL Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../01_overview.html">IBL data structure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_one.html">ONE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../04_alf.html">Alyx Files (ALF)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05_datajoint.html">Datajoint</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../07_tutorials.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../08_public.html">IBL Public Data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">Contribution Statement</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="one.html">one</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="brainbox.html">brainbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="brainbox.atlas.html">brainbox.atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.behavior.html">brainbox.behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.core.html">brainbox.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.ephys_plots.html">brainbox.ephys_plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.io.html">brainbox.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.lfp.html">brainbox.lfp</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.metrics.html">brainbox.metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.modeling.html">brainbox.modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.numerical.html">brainbox.numerical</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot.html">brainbox.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot_base.html">brainbox.plot_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.population.html">brainbox.population</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.processing.html">brainbox.processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.quality.html">brainbox.quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.singlecell.html">brainbox.singlecell</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.spike_features.html">brainbox.spike_features</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="brainbox.task.html">brainbox.task</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">brainbox.task.closed_loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="brainbox.task.passive.html">brainbox.task.passive</a></li>
<li class="toctree-l4"><a class="reference internal" href="brainbox.task.trials.html">brainbox.task.trials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.tests.html">brainbox.tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.video.html">brainbox.video</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../010_api_reference.html">API Reference</a> &raquo;</li>
        
          <li><a href="brainbox.html">brainbox</a> &raquo;</li>
        
          <li><a href="brainbox.task.html">brainbox.task</a> &raquo;</li>
        
      <li>brainbox.task.closed_loop</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/_autosummary/brainbox.task.closed_loop.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-brainbox.task.closed_loop">
<span id="brainbox-task-closed-loop"></span><h1>brainbox.task.closed_loop<a class="headerlink" href="#module-brainbox.task.closed_loop" title="Permalink to this headline">Â¶</a></h1>
<p>Computes task related output</p>
<p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.task.closed_loop._draw_contrast" title="brainbox.task.closed_loop._draw_contrast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_draw_contrast</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.task.closed_loop._draw_position" title="brainbox.task.closed_loop._draw_position"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_draw_position</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.task.closed_loop._get_biased_probs" title="brainbox.task.closed_loop._get_biased_probs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_get_biased_probs</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.differentiate_units" title="brainbox.task.closed_loop.differentiate_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">differentiate_units</span></code></a></p></td>
<td><p>Determine units which significantly differentiate between two task events (e.g.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.generate_pseudo_blocks" title="brainbox.task.closed_loop.generate_pseudo_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_pseudo_blocks</span></code></a></p></td>
<td><p>Generate a pseudo block structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.generate_pseudo_session" title="brainbox.task.closed_loop.generate_pseudo_session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_pseudo_session</span></code></a></p></td>
<td><p>Generate a complete pseudo session with biased blocks, all stimulus contrasts, choices and rewards and omissions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.generate_pseudo_stimuli" title="brainbox.task.closed_loop.generate_pseudo_stimuli"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_pseudo_stimuli</span></code></a></p></td>
<td><p>Generate a block structure with stimuli</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.responsive_units" title="brainbox.task.closed_loop.responsive_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">responsive_units</span></code></a></p></td>
<td><p>Determine responsive neurons by doing a Wilcoxon Signed-Rank test between a baseline period before a certain task event (e.g.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.roc_between_two_events" title="brainbox.task.closed_loop.roc_between_two_events"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roc_between_two_events</span></code></a></p></td>
<td><p>Calcluate area under the ROC curve that indicates how well the activity of the neuron distiguishes between two events (e.g.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.task.closed_loop.roc_single_event" title="brainbox.task.closed_loop.roc_single_event"><code class="xref py py-obj docutils literal notranslate"><span class="pre">roc_single_event</span></code></a></p></td>
<td><p>Determine how well neurons respond to a certain task event by calculating the area under the ROC curve between a baseline period before the event and a period after the event.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="brainbox.task.closed_loop.responsive_units">
<code class="sig-name descname">responsive_units</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">event_times</span></em>, <em class="sig-param"><span class="n">pre_time</span><span class="o">=</span><span class="default_value">[0.5, 0]</span></em>, <em class="sig-param"><span class="n">post_time</span><span class="o">=</span><span class="default_value">[0, 0.5]</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.05</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#responsive_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.responsive_units" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Determine responsive neurons by doing a Wilcoxon Signed-Rank test between a baseline period
before a certain task event (e.g. stimulus onset) and a period after the task event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_times</strong> (<em>1D array</em>) â spike times (in seconds)</p></li>
<li><p><strong>spike_clusters</strong> (<em>1D array</em>) â cluster ids corresponding to each event in <cite>spikes</cite></p></li>
<li><p><strong>event_times</strong> (<em>1D array</em>) â times (in seconds) of the events from the two groups</p></li>
<li><p><strong>pre_time</strong> (<em>two-element array</em>) â time (in seconds) preceding the event to get the baseline (e.g. [0.5, 0.2] would be a
window starting 0.5 seconds before the event and ending at 0.2 seconds before the event)</p></li>
<li><p><strong>post_time</strong> (<em>two-element array</em>) â time (in seconds) to follow the event times</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) â alpha to use for statistical significance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>significant_units</strong> (<em>ndarray</em>) â an array with the indices of clusters that are significatly modulated</p></li>
<li><p><strong>stats</strong> (<em>1D array</em>) â the statistic of the test that was performed</p></li>
<li><p><strong>p_values</strong> (<em>ndarray</em>) â the p-values of all the clusters</p></li>
<li><p><strong>cluster_ids</strong> (<em>ndarray</em>) â cluster ids of the p-values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop.differentiate_units">
<code class="sig-name descname">differentiate_units</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">event_times</span></em>, <em class="sig-param"><span class="n">event_groups</span></em>, <em class="sig-param"><span class="n">pre_time</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">post_time</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">test</span><span class="o">=</span><span class="default_value">'ranksums'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.05</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#differentiate_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.differentiate_units" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Determine units which significantly differentiate between two task events
(e.g. stimulus left/right) by performing a statistical test between the spike rates
elicited by the two events. Default is a Wilcoxon Rank Sum test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_times</strong> (<em>1D array</em>) â spike times (in seconds)</p></li>
<li><p><strong>spike_clusters</strong> (<em>1D array</em>) â cluster ids corresponding to each event in <cite>spikes</cite></p></li>
<li><p><strong>event_times</strong> (<em>1D array</em>) â times (in seconds) of the events from the two groups</p></li>
<li><p><strong>event_groups</strong> (<em>1D array</em>) â group identities of the events as either 0 or 1</p></li>
<li><p><strong>pre_time</strong> (<em>float</em>) â time (in seconds) to precede the event times to get the baseline</p></li>
<li><p><strong>post_time</strong> (<em>float</em>) â time (in seconds) to follow the event times</p></li>
<li><p><strong>test</strong> (<em>string</em>) â <dl class="simple">
<dt>which statistical test to use, options are:</dt><dd><p>âranksumsâ      Wilcoxon Rank Sums test
âsignrankâ      Wilcoxon Signed Rank test (for paired observations)
âttestâ         independent samples t-test
âpaired_ttestâ  paired t-test</p>
</dd>
</dl>
</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) â alpha to use for statistical significance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>significant_units</strong> (<em>1D array</em>) â an array with the indices of clusters that are significatly modulated</p></li>
<li><p><strong>stats</strong> (<em>1D array</em>) â the statistic of the test that was performed</p></li>
<li><p><strong>p_values</strong> (<em>1D array</em>) â the p-values of all the clusters</p></li>
<li><p><strong>cluster_ids</strong> (<em>ndarray</em>) â cluster ids of the p-values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop.roc_single_event">
<code class="sig-name descname">roc_single_event</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">event_times</span></em>, <em class="sig-param"><span class="n">pre_time</span><span class="o">=</span><span class="default_value">[0.5, 0]</span></em>, <em class="sig-param"><span class="n">post_time</span><span class="o">=</span><span class="default_value">[0, 0.5]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#roc_single_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.roc_single_event" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Determine how well neurons respond to a certain task event by calculating the area under the
ROC curve between a baseline period before the event and a period after the event.
Values of &gt; 0.5 indicate the neuron respons positively to the event and &lt; 0.5 indicate
a negative response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_times</strong> (<em>1D array</em>) â spike times (in seconds)</p></li>
<li><p><strong>spike_clusters</strong> (<em>1D array</em>) â cluster ids corresponding to each event in <cite>spikes</cite></p></li>
<li><p><strong>event_times</strong> (<em>1D array</em>) â times (in seconds) of the events from the two groups</p></li>
<li><p><strong>pre_time</strong> (<em>two-element array</em>) â time (in seconds) preceding the event to get the baseline (e.g. [0.5, 0.2] would be a
window starting 0.5 seconds before the event and ending at 0.2 seconds before the event)</p></li>
<li><p><strong>post_time</strong> (<em>two-element array</em>) â time (in seconds) to follow the event times</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>auc_roc</strong> (<em>1D array</em>) â the area under the ROC curve</p></li>
<li><p><strong>cluster_ids</strong> (<em>1D array</em>) â cluster ids of the p-values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop.roc_between_two_events">
<code class="sig-name descname">roc_between_two_events</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">event_times</span></em>, <em class="sig-param"><span class="n">event_groups</span></em>, <em class="sig-param"><span class="n">pre_time</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">post_time</span><span class="o">=</span><span class="default_value">0.25</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#roc_between_two_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.roc_between_two_events" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calcluate area under the ROC curve that indicates how well the activity of the neuron
distiguishes between two events (e.g. movement to the right vs left). A value of 0.5 indicates
the neuron cannot distiguish between the two events. A value of 0 or 1 indicates maximum
distinction. Significance is determined by bootstrapping the ROC curves. If 0.5 is not
included in the 95th percentile of the bootstrapped distribution, the neuron is deemed
to be significant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_times</strong> (<em>1D array</em>) â spike times (in seconds)</p></li>
<li><p><strong>spike_clusters</strong> (<em>1D array</em>) â cluster ids corresponding to each event in <cite>spikes</cite></p></li>
<li><p><strong>event_times</strong> (<em>1D array</em>) â times (in seconds) of the events from the two groups</p></li>
<li><p><strong>event_groups</strong> (<em>1D array</em>) â group identities of the events as either 0 or 1</p></li>
<li><p><strong>pre_time</strong> (<em>float</em>) â time (in seconds) to precede the event times</p></li>
<li><p><strong>post_time</strong> (<em>float</em>) â time (in seconds) to follow the event times</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>auc_roc</strong> (<em>1D array</em>) â an array of the area under the ROC curve for every neuron</p></li>
<li><p><strong>cluster_ids</strong> (<em>1D array</em>) â cluster ids of the AUC values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop._get_biased_probs">
<code class="sig-name descname">_get_biased_probs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">idx</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">prob</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#_get_biased_probs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop._get_biased_probs" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop._draw_contrast">
<code class="sig-name descname">_draw_contrast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">contrast_set</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">prob_type</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'biased'</span></em>, <em class="sig-param"><span class="n">idx</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">idx_prob</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#_draw_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop._draw_contrast" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop._draw_position">
<code class="sig-name descname">_draw_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">position_set</span></em>, <em class="sig-param"><span class="n">stim_probability_left</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#_draw_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop._draw_position" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop.generate_pseudo_blocks">
<code class="sig-name descname">generate_pseudo_blocks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_trials</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">min_</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">max_</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">first5050</span><span class="o">=</span><span class="default_value">90</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#generate_pseudo_blocks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.generate_pseudo_blocks" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate a pseudo block structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_trials</strong> (<em>int</em>) â how many trials to generate</p></li>
<li><p><strong>factor</strong> (<em>int</em>) â factor of the exponential</p></li>
<li><p><strong>min</strong> (<em>int</em>) â minimum number of trials per block</p></li>
<li><p><strong>max</strong> (<em>int</em>) â maximum number of trials per block</p></li>
<li><p><strong>first5050</strong> (<em>int</em>) â amount of trials with 50/50 left right probability at the beginning</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>probabilityLeft</strong> â array with probability left per trial</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop.generate_pseudo_stimuli">
<code class="sig-name descname">generate_pseudo_stimuli</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_trials</span></em>, <em class="sig-param"><span class="n">contrast_set</span><span class="o">=</span><span class="default_value">[0, 0.06, 0.12, 0.25, 1]</span></em>, <em class="sig-param"><span class="n">first5050</span><span class="o">=</span><span class="default_value">90</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#generate_pseudo_stimuli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.generate_pseudo_stimuli" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate a block structure with stimuli</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_trials</strong> (<em>int</em>) â number of trials to generate</p></li>
<li><p><strong>contrast_set</strong> (<em>1D array</em>) â the contrasts that are presented. The default is [0.06, 0.12, 0.25, 1].</p></li>
<li><p><strong>first5050</strong> (<em>int</em>) â Number of 50/50 trials at the beginning of the session. The default is 90.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>p_left</strong> (<em>1D array</em>) â probability of left stimulus</p></li>
<li><p><strong>contrast_left</strong> (<em>1D array</em>) â contrast on the left</p></li>
<li><p><strong>contrast_right</strong> (<em>1D array</em>) â contrast on the right</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.task.closed_loop.generate_pseudo_session">
<code class="sig-name descname">generate_pseudo_session</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trials</span></em>, <em class="sig-param"><span class="n">generate_choices</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/task/closed_loop.html#generate_pseudo_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.task.closed_loop.generate_pseudo_session" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate a complete pseudo session with biased blocks, all stimulus contrasts, choices and
rewards and omissions. Biased blocks and stimulus contrasts are generated using the same
statistics as used in the actual task. The choices of the animal are generated using the
actual psychometrics of the animal in the session. For each synthetic trial the choice is
determined by drawing from a Bernoulli distribution that is biased according to the proportion
of times the animal chose left for the stimulus contrast, side, and block probability.
No-go trials are ignored in the generating of the synthetic choices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trials</strong> (<em>DataFrame</em>) â Pandas dataframe with columns as trial vectors loaded using ONE</p></li>
<li><p><strong>generate_choices</strong> (<em>bool</em>) â whether to generate the choices (runs faster without)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pseudo_trials</strong> â a trials dataframe with synthetically generated trials</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="brainbox.task.passive.html" class="btn btn-neutral float-right" title="brainbox.task.passive" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="brainbox.task.html" class="btn btn-neutral float-left" title="brainbox.task" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, International Brain Laboratory

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>