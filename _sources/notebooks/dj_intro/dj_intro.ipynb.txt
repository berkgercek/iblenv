{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Datajoint Introductory Tutorial\n",
    "In this tutorial we will use datajoint to replicate the analysis we conducted in the [ONE tutorial](../one_intro/one_intro.html)\n",
    "\n",
    "This tutorial assumes that you have setup the unified ibl environment [IBL python environment](../../02_installation.md) and set up your [Datajoint credentials](../../dj_docs/dj_credentials.md).\n",
    "\n",
    "First let's import datajoint"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import datajoint as dj\n",
    "# for the purposes of tutorial limit the table print output to 5\n",
    "dj.config['display.limit'] = 5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can access datajoint tables by importing schemas from the IBL-pipeline. Let's import the `subject` schema"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Connecting mayofaulkner@datajoint.internationalbrainlab.org:3306\n"
     ]
    }
   ],
   "source": [
    "from ibl_pipeline import subject"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Within this schema there is a datajoint table called `Subject`. This holds all the information about subjects registered on Alyx under IBL projects. Let's access this table and look at the first couple of entries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "        \n",
       "        <style type=\"text/css\">\n",
       "            .Relation{\n",
       "                border-collapse:collapse;\n",
       "            }\n",
       "            .Relation th{\n",
       "                background: #A0A0A0; color: #ffffff; padding:4px; border:#f0e0e0 1px solid;\n",
       "                font-weight: normal; font-family: monospace; font-size: 100%;\n",
       "            }\n",
       "            .Relation td{\n",
       "                padding:4px; border:#f0e0e0 1px solid; font-size:100%;\n",
       "            }\n",
       "            .Relation tr:nth-child(odd){\n",
       "                background: #ffffff;\n",
       "            }\n",
       "            .Relation tr:nth-child(even){\n",
       "                background: #f3f1ff;\n",
       "            }\n",
       "            /* Tooltip container */\n",
       "            .djtooltip {\n",
       "            }\n",
       "            /* Tooltip text */\n",
       "            .djtooltip .djtooltiptext {\n",
       "                visibility: hidden;\n",
       "                width: 120px;\n",
       "                background-color: black;\n",
       "                color: #fff;\n",
       "                text-align: center;\n",
       "                padding: 5px 0;\n",
       "                border-radius: 6px;\n",
       "                /* Position the tooltip text - see examples below! */\n",
       "                position: absolute;\n",
       "                z-index: 1;\n",
       "            }\n",
       "            #primary {\n",
       "                font-weight: bold;\n",
       "                color: black;\n",
       "            }\n",
       "\n",
       "            #nonprimary {\n",
       "                font-weight: normal;\n",
       "                color: white;\n",
       "            }\n",
       "\n",
       "            /* Show the tooltip text when you mouse over the tooltip container */\n",
       "            .djtooltip:hover .djtooltiptext {\n",
       "                visibility: visible;\n",
       "            }\n",
       "        </style>\n",
       "        \n",
       "        <b></b>\n",
       "            <div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "            <table border=\"1\" class=\"Relation\">\n",
       "                <thead> <tr style=\"text-align: right;\"> <th> <div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">subject_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_nickname</p>\n",
       "                                <span class=\"djtooltiptext\">nickname</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">sex</p>\n",
       "                                <span class=\"djtooltiptext\">sex</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_birth_date</p>\n",
       "                                <span class=\"djtooltiptext\">birth date</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">ear_mark</p>\n",
       "                                <span class=\"djtooltiptext\">ear mark</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_line</p>\n",
       "                                <span class=\"djtooltiptext\">name</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_source</p>\n",
       "                                <span class=\"djtooltiptext\">name of source</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">protocol_number</p>\n",
       "                                <span class=\"djtooltiptext\">protocol number</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_description</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_ts</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_strain</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div> </th> </tr> </thead>\n",
       "                <tbody> <tr> <td>0026c82d-39e4-4c6b-acb3-303eb4b24f05</td>\n",
       "<td>IBL_32</td>\n",
       "<td>M</td>\n",
       "<td>2018-04-23</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6NCrl</td>\n",
       "<td>Charles River</td>\n",
       "<td>1</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-06 21:30:42</td>\n",
       "<td>C57BL/6N</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>KS019</td>\n",
       "<td>F</td>\n",
       "<td>2019-04-30</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>2</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-13 17:07:33</td>\n",
       "<td>C57BL/6J</td></tr><tr><td>00c60db3-74c3-4ee2-9df9-2c84acf84e92</td>\n",
       "<td>ibl_witten_10</td>\n",
       "<td>F</td>\n",
       "<td>2018-11-13</td>\n",
       "<td>notag</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>Jax</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-25 01:33:25</td>\n",
       "<td>C57BL/6J</td></tr><tr><td>0124f697-16ce-4f59-b87c-e53fcb3a27ac</td>\n",
       "<td>6867</td>\n",
       "<td>M</td>\n",
       "<td>2018-06-25</td>\n",
       "<td>None</td>\n",
       "<td>Thy1-GCaMP6s</td>\n",
       "<td>CCU - Margarida colonies</td>\n",
       "<td>1</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-25 01:33:25</td>\n",
       "<td>C57BL/6J</td></tr><tr><td>019a22c1-b944-4494-9e38-0e45ae6697bf</td>\n",
       "<td>SWC_022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-18</td>\n",
       "<td>NA (Front HP)</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>Charles River</td>\n",
       "<td>4</td>\n",
       "<td>ID: 990762</td>\n",
       "<td>2019-09-25 01:33:25</td>\n",
       "<td>C57BL/6J</td> </tr> </tbody>\n",
       "            </table>\n",
       "            <p>...</p>\n",
       "            <p>Total: 856</p></div>\n",
       "            "
      ],
      "text/plain": [
       "*subject_uuid  subject_nickna sex     subject_birth_ ear_mark       subject_line   subject_source protocol_numbe subject_descri subject_ts     subject_strain\n",
       "+------------+ +------------+ +-----+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+\n",
       "0026c82d-39e4- IBL_32         M       2018-04-23     None           C57BL/6NCrl    Charles River  1              None           2019-08-06 21: C57BL/6N      \n",
       "00778394-c956- KS019          F       2019-04-30     None           C57BL/6J       None           2              None           2019-08-13 17: C57BL/6J      \n",
       "00c60db3-74c3- ibl_witten_10  F       2018-11-13     notag          C57BL/6J       Jax            3              None           2019-09-25 01: C57BL/6J      \n",
       "0124f697-16ce- 6867           M       2018-06-25     None           Thy1-GCaMP6s   CCU - Margarid 1              None           2019-09-25 01: C57BL/6J      \n",
       "019a22c1-b944- SWC_022        M       2019-06-18     NA (Front HP)  C57BL/6J       Charles River  4              ID: 990762     2019-09-25 01: C57BL/6J      \n",
       "   ...\n",
       " (Total: 856)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "subjects = subject.Subject()\n",
    "subjects"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next, we will find the entry in the table for the same subject that we looked at in the ONE tutorial, KS022. To do this we will restrict the `Subject` table by the `subject nickname`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "        \n",
       "        <style type=\"text/css\">\n",
       "            .Relation{\n",
       "                border-collapse:collapse;\n",
       "            }\n",
       "            .Relation th{\n",
       "                background: #A0A0A0; color: #ffffff; padding:4px; border:#f0e0e0 1px solid;\n",
       "                font-weight: normal; font-family: monospace; font-size: 100%;\n",
       "            }\n",
       "            .Relation td{\n",
       "                padding:4px; border:#f0e0e0 1px solid; font-size:100%;\n",
       "            }\n",
       "            .Relation tr:nth-child(odd){\n",
       "                background: #ffffff;\n",
       "            }\n",
       "            .Relation tr:nth-child(even){\n",
       "                background: #f3f1ff;\n",
       "            }\n",
       "            /* Tooltip container */\n",
       "            .djtooltip {\n",
       "            }\n",
       "            /* Tooltip text */\n",
       "            .djtooltip .djtooltiptext {\n",
       "                visibility: hidden;\n",
       "                width: 120px;\n",
       "                background-color: black;\n",
       "                color: #fff;\n",
       "                text-align: center;\n",
       "                padding: 5px 0;\n",
       "                border-radius: 6px;\n",
       "                /* Position the tooltip text - see examples below! */\n",
       "                position: absolute;\n",
       "                z-index: 1;\n",
       "            }\n",
       "            #primary {\n",
       "                font-weight: bold;\n",
       "                color: black;\n",
       "            }\n",
       "\n",
       "            #nonprimary {\n",
       "                font-weight: normal;\n",
       "                color: white;\n",
       "            }\n",
       "\n",
       "            /* Show the tooltip text when you mouse over the tooltip container */\n",
       "            .djtooltip:hover .djtooltiptext {\n",
       "                visibility: visible;\n",
       "            }\n",
       "        </style>\n",
       "        \n",
       "        <b></b>\n",
       "            <div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "            <table border=\"1\" class=\"Relation\">\n",
       "                <thead> <tr style=\"text-align: right;\"> <th> <div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">subject_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_nickname</p>\n",
       "                                <span class=\"djtooltiptext\">nickname</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">sex</p>\n",
       "                                <span class=\"djtooltiptext\">sex</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_birth_date</p>\n",
       "                                <span class=\"djtooltiptext\">birth date</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">ear_mark</p>\n",
       "                                <span class=\"djtooltiptext\">ear mark</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_line</p>\n",
       "                                <span class=\"djtooltiptext\">name</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_source</p>\n",
       "                                <span class=\"djtooltiptext\">name of source</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">protocol_number</p>\n",
       "                                <span class=\"djtooltiptext\">protocol number</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_description</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_ts</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_strain</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div> </th> </tr> </thead>\n",
       "                <tbody> <tr> <td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>KS022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-25</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-20 04:28:14</td>\n",
       "<td>C57BL/6J</td> </tr> </tbody>\n",
       "            </table>\n",
       "            \n",
       "            <p>Total: 1</p></div>\n",
       "            "
      ],
      "text/plain": [
       "*subject_uuid  subject_nickna sex     subject_birth_ ear_mark     subject_line   subject_source protocol_numbe subject_descri subject_ts     subject_strain\n",
       "+------------+ +------------+ +-----+ +------------+ +----------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+\n",
       "b57c1934-f9d1- KS022          M       2019-06-25     None         C57BL/6J       None           3              None           2019-09-20 04: C57BL/6J      \n",
       " (Total: 1)"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "subjects & 'subject_nickname = \"KS022\"'"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We now want to find information about the behavioural sessions. This information is stored in a table `Session` defined in the `acquisition` schema. Let's import this schema, access the table and display the first few entries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "        \n",
       "        <style type=\"text/css\">\n",
       "            .Relation{\n",
       "                border-collapse:collapse;\n",
       "            }\n",
       "            .Relation th{\n",
       "                background: #A0A0A0; color: #ffffff; padding:4px; border:#f0e0e0 1px solid;\n",
       "                font-weight: normal; font-family: monospace; font-size: 100%;\n",
       "            }\n",
       "            .Relation td{\n",
       "                padding:4px; border:#f0e0e0 1px solid; font-size:100%;\n",
       "            }\n",
       "            .Relation tr:nth-child(odd){\n",
       "                background: #ffffff;\n",
       "            }\n",
       "            .Relation tr:nth-child(even){\n",
       "                background: #f3f1ff;\n",
       "            }\n",
       "            /* Tooltip container */\n",
       "            .djtooltip {\n",
       "            }\n",
       "            /* Tooltip text */\n",
       "            .djtooltip .djtooltiptext {\n",
       "                visibility: hidden;\n",
       "                width: 120px;\n",
       "                background-color: black;\n",
       "                color: #fff;\n",
       "                text-align: center;\n",
       "                padding: 5px 0;\n",
       "                border-radius: 6px;\n",
       "                /* Position the tooltip text - see examples below! */\n",
       "                position: absolute;\n",
       "                z-index: 1;\n",
       "            }\n",
       "            #primary {\n",
       "                font-weight: bold;\n",
       "                color: black;\n",
       "            }\n",
       "\n",
       "            #nonprimary {\n",
       "                font-weight: normal;\n",
       "                color: white;\n",
       "            }\n",
       "\n",
       "            /* Show the tooltip text when you mouse over the tooltip container */\n",
       "            .djtooltip:hover .djtooltiptext {\n",
       "                visibility: visible;\n",
       "            }\n",
       "        </style>\n",
       "        \n",
       "        <b></b>\n",
       "            <div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "            <table border=\"1\" class=\"Relation\">\n",
       "                <thead> <tr style=\"text-align: right;\"> <th> <div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">subject_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">session_start_time</p>\n",
       "                                <span class=\"djtooltiptext\">start time</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_number</p>\n",
       "                                <span class=\"djtooltiptext\">number</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_end_time</p>\n",
       "                                <span class=\"djtooltiptext\">end time</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_lab</p>\n",
       "                                <span class=\"djtooltiptext\">name of lab</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_location</p>\n",
       "                                <span class=\"djtooltiptext\">name of the location</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">task_protocol</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_type</p>\n",
       "                                <span class=\"djtooltiptext\">type</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_narrative</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_ts</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div> </th> </tr> </thead>\n",
       "                <tbody> <tr> <td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-07 10:49:41</td>\n",
       "<td>0955e23e-90cf-4250-a092-82fabdf67a24</td>\n",
       "<td>1</td>\n",
       "<td>2019-08-07 11:23:14</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_habituationChoiceWorld5.2.5</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-13 17:26:00</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-08 15:32:40</td>\n",
       "<td>996167fa-07bc-4afe-b7b9-4aee0ba75c1f</td>\n",
       "<td>1</td>\n",
       "<td>2019-08-08 16:19:23</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_habituationChoiceWorld5.2.5</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-13 17:26:01</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-09 10:37:49</td>\n",
       "<td>13e38e6c-0cd6-41f9-a2ab-8d6021fea035</td>\n",
       "<td>1</td>\n",
       "<td>2019-08-09 11:40:12</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_habituationChoiceWorld5.2.7</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-13 17:26:00</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-10 11:24:59</td>\n",
       "<td>fb9bdf18-76be-452b-ac4e-21d5de3a6f9f</td>\n",
       "<td>1</td>\n",
       "<td>2019-08-10 12:11:04</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.2.7</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-13 17:26:06</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-12 09:21:03</td>\n",
       "<td>d47e9a4c-18dc-4d4d-991c-d30059ec2cbd</td>\n",
       "<td>1</td>\n",
       "<td>2019-08-12 10:07:19</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.2.7</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-08-14 12:37:53</td> </tr> </tbody>\n",
       "            </table>\n",
       "            <p>...</p>\n",
       "            <p>Total: 26634</p></div>\n",
       "            "
      ],
      "text/plain": [
       "*subject_uuid  *session_start session_uuid   session_number session_end_ti session_lab    session_locati task_protocol  session_type   session_narrat session_ts    \n",
       "+------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+\n",
       "00778394-c956- 2019-08-07 10: 0955e23e-90cf- 1              2019-08-07 11: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-08-13 17:\n",
       "00778394-c956- 2019-08-08 15: 996167fa-07bc- 1              2019-08-08 16: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-08-13 17:\n",
       "00778394-c956- 2019-08-09 10: 13e38e6c-0cd6- 1              2019-08-09 11: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-08-13 17:\n",
       "00778394-c956- 2019-08-10 11: fb9bdf18-76be- 1              2019-08-10 12: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-08-13 17:\n",
       "00778394-c956- 2019-08-12 09: d47e9a4c-18dc- 1              2019-08-12 10: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-08-14 12:\n",
       "   ...\n",
       " (Total: 26634)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from ibl_pipeline import acquisition\n",
    "sessions = acquisition.Session()\n",
    "sessions"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "If we look at the primary keys (columns with black headings) in the `Subjects` and `Sessions` table, we will notice that both contain `subject_uuid` as a primary key. This means that these two tables can be joined using *****. \n",
    "\n",
    "We want to find information about all the sessions that KS022 did in the training phase of the IBL training pipeline. When combining the tables we will therefore restrict the `Subject` table by the `subject nickname` (as we did before) and the `Sessions` table by the `task protocol`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "        \n",
       "        <style type=\"text/css\">\n",
       "            .Relation{\n",
       "                border-collapse:collapse;\n",
       "            }\n",
       "            .Relation th{\n",
       "                background: #A0A0A0; color: #ffffff; padding:4px; border:#f0e0e0 1px solid;\n",
       "                font-weight: normal; font-family: monospace; font-size: 100%;\n",
       "            }\n",
       "            .Relation td{\n",
       "                padding:4px; border:#f0e0e0 1px solid; font-size:100%;\n",
       "            }\n",
       "            .Relation tr:nth-child(odd){\n",
       "                background: #ffffff;\n",
       "            }\n",
       "            .Relation tr:nth-child(even){\n",
       "                background: #f3f1ff;\n",
       "            }\n",
       "            /* Tooltip container */\n",
       "            .djtooltip {\n",
       "            }\n",
       "            /* Tooltip text */\n",
       "            .djtooltip .djtooltiptext {\n",
       "                visibility: hidden;\n",
       "                width: 120px;\n",
       "                background-color: black;\n",
       "                color: #fff;\n",
       "                text-align: center;\n",
       "                padding: 5px 0;\n",
       "                border-radius: 6px;\n",
       "                /* Position the tooltip text - see examples below! */\n",
       "                position: absolute;\n",
       "                z-index: 1;\n",
       "            }\n",
       "            #primary {\n",
       "                font-weight: bold;\n",
       "                color: black;\n",
       "            }\n",
       "\n",
       "            #nonprimary {\n",
       "                font-weight: normal;\n",
       "                color: white;\n",
       "            }\n",
       "\n",
       "            /* Show the tooltip text when you mouse over the tooltip container */\n",
       "            .djtooltip:hover .djtooltiptext {\n",
       "                visibility: visible;\n",
       "            }\n",
       "        </style>\n",
       "        \n",
       "        \n",
       "            <div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "            <table border=\"1\" class=\"Relation\">\n",
       "                <thead> <tr style=\"text-align: right;\"> <th> <div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">subject_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">session_start_time</p>\n",
       "                                <span class=\"djtooltiptext\">start time</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_nickname</p>\n",
       "                                <span class=\"djtooltiptext\">nickname</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">sex</p>\n",
       "                                <span class=\"djtooltiptext\">sex</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_birth_date</p>\n",
       "                                <span class=\"djtooltiptext\">birth date</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">ear_mark</p>\n",
       "                                <span class=\"djtooltiptext\">ear mark</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_line</p>\n",
       "                                <span class=\"djtooltiptext\">name</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_source</p>\n",
       "                                <span class=\"djtooltiptext\">name of source</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">protocol_number</p>\n",
       "                                <span class=\"djtooltiptext\">protocol number</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_description</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_ts</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">subject_strain</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_number</p>\n",
       "                                <span class=\"djtooltiptext\">number</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_end_time</p>\n",
       "                                <span class=\"djtooltiptext\">end time</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_lab</p>\n",
       "                                <span class=\"djtooltiptext\">name of lab</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_location</p>\n",
       "                                <span class=\"djtooltiptext\">name of the location</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">task_protocol</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_type</p>\n",
       "                                <span class=\"djtooltiptext\">type</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_narrative</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_ts</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div> </th> </tr> </thead>\n",
       "                <tbody> <tr> <td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-23 13:43:40</td>\n",
       "<td>KS022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-25</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-20 04:28:14</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>242ed7aa-6e02-4d55-b003-874b71357074</td>\n",
       "<td>1</td>\n",
       "<td>2019-09-23 14:28:22</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.3.0</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-24 04:51:41</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-24 10:41:18</td>\n",
       "<td>KS022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-25</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-20 04:28:14</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>be7f7832-006f-4f79-8079-6dea549c90c0</td>\n",
       "<td>1</td>\n",
       "<td>2019-09-24 11:27:11</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.3.0</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-25 04:51:58</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-25 09:37:26</td>\n",
       "<td>KS022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-25</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-20 04:28:14</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>c4f55950-26ac-4cb6-be38-57d9e604f5fc</td>\n",
       "<td>1</td>\n",
       "<td>2019-09-25 10:23:20</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.3.0</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-26 04:53:06</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-26 14:43:24</td>\n",
       "<td>KS022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-25</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-20 04:28:14</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>39a0993b-ea91-4d7d-aa8b-84365ae77a81</td>\n",
       "<td>1</td>\n",
       "<td>2019-09-26 15:31:48</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.3.0</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-27 04:53:22</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-27 10:21:16</td>\n",
       "<td>KS022</td>\n",
       "<td>M</td>\n",
       "<td>2019-06-25</td>\n",
       "<td>None</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>None</td>\n",
       "<td>3</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-20 04:28:14</td>\n",
       "<td>C57BL/6J</td>\n",
       "<td>f1eb053b-3cc2-45df-bbd5-2f5f54f05d23</td>\n",
       "<td>1</td>\n",
       "<td>2019-09-27 11:06:09</td>\n",
       "<td>cortexlab</td>\n",
       "<td>_iblrig_cortexlab_behavior_3</td>\n",
       "<td>_iblrig_tasks_trainingChoiceWorld5.3.0</td>\n",
       "<td>Experiment</td>\n",
       "<td>None</td>\n",
       "<td>2019-09-28 04:53:37</td> </tr> </tbody>\n",
       "            </table>\n",
       "            <p>...</p>\n",
       "            <p>Total: 19</p></div>\n",
       "            "
      ],
      "text/plain": [
       "*subject_uuid  *session_start subject_nickna sex     subject_birth_ ear_mark     subject_line   subject_source protocol_numbe subject_descri subject_ts     subject_strain session_uuid   session_number session_end_ti session_lab    session_locati task_protocol  session_type   session_narrat session_ts    \n",
       "+------------+ +------------+ +------------+ +-----+ +------------+ +----------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+ +------------+\n",
       "b57c1934-f9d1- 2019-09-23 13: KS022          M       2019-06-25     None         C57BL/6J       None           3              None           2019-09-20 04: C57BL/6J       242ed7aa-6e02- 1              2019-09-23 14: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-09-24 04:\n",
       "b57c1934-f9d1- 2019-09-24 10: KS022          M       2019-06-25     None         C57BL/6J       None           3              None           2019-09-20 04: C57BL/6J       be7f7832-006f- 1              2019-09-24 11: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-09-25 04:\n",
       "b57c1934-f9d1- 2019-09-25 09: KS022          M       2019-06-25     None         C57BL/6J       None           3              None           2019-09-20 04: C57BL/6J       c4f55950-26ac- 1              2019-09-25 10: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-09-26 04:\n",
       "b57c1934-f9d1- 2019-09-26 14: KS022          M       2019-06-25     None         C57BL/6J       None           3              None           2019-09-20 04: C57BL/6J       39a0993b-ea91- 1              2019-09-26 15: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-09-27 04:\n",
       "b57c1934-f9d1- 2019-09-27 10: KS022          M       2019-06-25     None         C57BL/6J       None           3              None           2019-09-20 04: C57BL/6J       f1eb053b-3cc2- 1              2019-09-27 11: cortexlab      _iblrig_cortex _iblrig_tasks_ Experiment     None           2019-09-28 04:\n",
       "   ...\n",
       " (Total: 19)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(subjects & 'subject_nickname = \"KS022\"') * (sessions & 'task_protocol LIKE \"%training%\"')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There is a lot of information in this table and we are not interested in all of it for the purposes of our analysis. Let's just use the **proj** method to restrict the data presented. We do not want any columns from the `Subject` table (apart from the primary keys) and only want `session_uuid` from the `Sesssions table`. So we can write,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "        \n",
       "        <style type=\"text/css\">\n",
       "            .Relation{\n",
       "                border-collapse:collapse;\n",
       "            }\n",
       "            .Relation th{\n",
       "                background: #A0A0A0; color: #ffffff; padding:4px; border:#f0e0e0 1px solid;\n",
       "                font-weight: normal; font-family: monospace; font-size: 100%;\n",
       "            }\n",
       "            .Relation td{\n",
       "                padding:4px; border:#f0e0e0 1px solid; font-size:100%;\n",
       "            }\n",
       "            .Relation tr:nth-child(odd){\n",
       "                background: #ffffff;\n",
       "            }\n",
       "            .Relation tr:nth-child(even){\n",
       "                background: #f3f1ff;\n",
       "            }\n",
       "            /* Tooltip container */\n",
       "            .djtooltip {\n",
       "            }\n",
       "            /* Tooltip text */\n",
       "            .djtooltip .djtooltiptext {\n",
       "                visibility: hidden;\n",
       "                width: 120px;\n",
       "                background-color: black;\n",
       "                color: #fff;\n",
       "                text-align: center;\n",
       "                padding: 5px 0;\n",
       "                border-radius: 6px;\n",
       "                /* Position the tooltip text - see examples below! */\n",
       "                position: absolute;\n",
       "                z-index: 1;\n",
       "            }\n",
       "            #primary {\n",
       "                font-weight: bold;\n",
       "                color: black;\n",
       "            }\n",
       "\n",
       "            #nonprimary {\n",
       "                font-weight: normal;\n",
       "                color: white;\n",
       "            }\n",
       "\n",
       "            /* Show the tooltip text when you mouse over the tooltip container */\n",
       "            .djtooltip:hover .djtooltiptext {\n",
       "                visibility: visible;\n",
       "            }\n",
       "        </style>\n",
       "        \n",
       "        \n",
       "            <div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "            <table border=\"1\" class=\"Relation\">\n",
       "                <thead> <tr style=\"text-align: right;\"> <th> <div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">subject_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">session_start_time</p>\n",
       "                                <span class=\"djtooltiptext\">start time</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">session_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div> </th> </tr> </thead>\n",
       "                <tbody> <tr> <td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-23 13:43:40</td>\n",
       "<td>242ed7aa-6e02-4d55-b003-874b71357074</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-24 10:41:18</td>\n",
       "<td>be7f7832-006f-4f79-8079-6dea549c90c0</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-25 09:37:26</td>\n",
       "<td>c4f55950-26ac-4cb6-be38-57d9e604f5fc</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-26 14:43:24</td>\n",
       "<td>39a0993b-ea91-4d7d-aa8b-84365ae77a81</td></tr><tr><td>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</td>\n",
       "<td>2019-09-27 10:21:16</td>\n",
       "<td>f1eb053b-3cc2-45df-bbd5-2f5f54f05d23</td> </tr> </tbody>\n",
       "            </table>\n",
       "            <p>...</p>\n",
       "            <p>Total: 19</p></div>\n",
       "            "
      ],
      "text/plain": [
       "*subject_uuid  *session_start session_uuid  \n",
       "+------------+ +------------+ +------------+\n",
       "b57c1934-f9d1- 2019-09-23 13: 242ed7aa-6e02-\n",
       "b57c1934-f9d1- 2019-09-24 10: be7f7832-006f-\n",
       "b57c1934-f9d1- 2019-09-25 09: c4f55950-26ac-\n",
       "b57c1934-f9d1- 2019-09-26 14: 39a0993b-ea91-\n",
       "b57c1934-f9d1- 2019-09-27 10: f1eb053b-3cc2-\n",
       "   ...\n",
       " (Total: 19)"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "((subjects & 'subject_nickname = \"KS022\"').proj() *\n",
    " (sessions & 'task_protocol LIKE \"%training%\"')).proj('session_uuid')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\">\n",
    "\n",
    "Note\n",
    "\n",
    "In the above expression we first used **proj** and then joined the tables using ** * **. We could have also joined the tables first and then used **proj**,\n",
    "\n",
    "```\n",
    " ((subjects & 'subject_nickname = \"KS022\"') * (sessions & 'task_protocol LIKE \"%training%\"')\n",
    ").proj('session_uuid')\n",
    "```\n",
    "\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "If we look back to the [ONE tutorial](../one_intro/one_intro.html) you will notice that we have the same number of training sessions and that `session_uuid` corresponds to what we previously defined as the eID"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Up until now we have been inspecting the content of the tables but do not actually have access to the content. This is because we have not actually read the data from the tables into memory yet. For this we would need to use the **fetch** command. Let's fetch the `session uuid` information into a pandas dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "eids = ((subjects & 'subject_nickname = \"KS022\"').proj() *\n",
    "        (sessions & 'task_protocol LIKE \"%training%\"').proj('session_uuid')).fetch(format='frame')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>session_uuid</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>subject_uuid</th>\n",
       "      <th>session_start_time</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"19\" valign=\"top\">b57c1934-f9d1-4dc4-a474-e2cb4acdf918</th>\n",
       "      <th>2019-09-23 13:43:40</th>\n",
       "      <td>242ed7aa-6e02-4d55-b003-874b71357074</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-09-24 10:41:18</th>\n",
       "      <td>be7f7832-006f-4f79-8079-6dea549c90c0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-09-25 09:37:26</th>\n",
       "      <td>c4f55950-26ac-4cb6-be38-57d9e604f5fc</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-09-26 14:43:24</th>\n",
       "      <td>39a0993b-ea91-4d7d-aa8b-84365ae77a81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-09-27 10:21:16</th>\n",
       "      <td>f1eb053b-3cc2-45df-bbd5-2f5f54f05d23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-01 11:01:44</th>\n",
       "      <td>a07e255f-cf31-47aa-9667-5c62b93443e0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-02 10:02:36</th>\n",
       "      <td>fc7b7ea7-55c4-48fd-bb7b-2422c741fe8e</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-03 14:15:32</th>\n",
       "      <td>22f33af3-5e77-4517-94b9-2cfefea27a10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-04 10:52:19</th>\n",
       "      <td>7e508dce-e08c-4481-b634-1a9358673aa5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-07 10:59:27</th>\n",
       "      <td>548ca39d-8898-460c-a930-785083b4127d</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-08 11:19:34</th>\n",
       "      <td>3f815a05-a114-4a16-96ef-b398bd5a0b88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-10 11:00:46</th>\n",
       "      <td>f6c9daee-3e1e-4a5d-b372-7be8fcda5512</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-11 11:01:47</th>\n",
       "      <td>2f7e07d4-d713-46a1-8bce-6b497af405fc</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-14 11:30:31</th>\n",
       "      <td>228b29b2-fb77-40c9-bd32-953fd5297896</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-15 10:32:56</th>\n",
       "      <td>9ee8bd6b-1e5e-4440-bc2e-7c001abe7b60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-17 11:32:30</th>\n",
       "      <td>777ecfb9-616f-4ff9-a8d9-eb38f897a19f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-18 11:52:53</th>\n",
       "      <td>4e626e22-747e-4324-96f1-9827b7ca950d</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-21 11:44:49</th>\n",
       "      <td>dd4ad209-fcff-4252-9e38-44cba17f7603</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-10-22 11:48:05</th>\n",
       "      <td>b4ac5904-5693-4d98-adb3-362e612836be</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                  session_uuid\n",
       "subject_uuid                         session_start_time                                       \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40  242ed7aa-6e02-4d55-b003-874b71357074\n",
       "                                     2019-09-24 10:41:18  be7f7832-006f-4f79-8079-6dea549c90c0\n",
       "                                     2019-09-25 09:37:26  c4f55950-26ac-4cb6-be38-57d9e604f5fc\n",
       "                                     2019-09-26 14:43:24  39a0993b-ea91-4d7d-aa8b-84365ae77a81\n",
       "                                     2019-09-27 10:21:16  f1eb053b-3cc2-45df-bbd5-2f5f54f05d23\n",
       "                                     2019-10-01 11:01:44  a07e255f-cf31-47aa-9667-5c62b93443e0\n",
       "                                     2019-10-02 10:02:36  fc7b7ea7-55c4-48fd-bb7b-2422c741fe8e\n",
       "                                     2019-10-03 14:15:32  22f33af3-5e77-4517-94b9-2cfefea27a10\n",
       "                                     2019-10-04 10:52:19  7e508dce-e08c-4481-b634-1a9358673aa5\n",
       "                                     2019-10-07 10:59:27  548ca39d-8898-460c-a930-785083b4127d\n",
       "                                     2019-10-08 11:19:34  3f815a05-a114-4a16-96ef-b398bd5a0b88\n",
       "                                     2019-10-10 11:00:46  f6c9daee-3e1e-4a5d-b372-7be8fcda5512\n",
       "                                     2019-10-11 11:01:47  2f7e07d4-d713-46a1-8bce-6b497af405fc\n",
       "                                     2019-10-14 11:30:31  228b29b2-fb77-40c9-bd32-953fd5297896\n",
       "                                     2019-10-15 10:32:56  9ee8bd6b-1e5e-4440-bc2e-7c001abe7b60\n",
       "                                     2019-10-17 11:32:30  777ecfb9-616f-4ff9-a8d9-eb38f897a19f\n",
       "                                     2019-10-18 11:52:53  4e626e22-747e-4324-96f1-9827b7ca950d\n",
       "                                     2019-10-21 11:44:49  dd4ad209-fcff-4252-9e38-44cba17f7603\n",
       "                                     2019-10-22 11:48:05  b4ac5904-5693-4d98-adb3-362e612836be"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "eids"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now that we have access to our list of session eIDs, we can get trial information associated with these sessions. The output from the trials dataset is stored in a table called `PyschResults`. We can import this from the `analyses.behaviour` schema"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Connected to https://alyx.internationalbrainlab.org as mayo"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "\n",
       "        \n",
       "        <style type=\"text/css\">\n",
       "            .Relation{\n",
       "                border-collapse:collapse;\n",
       "            }\n",
       "            .Relation th{\n",
       "                background: #A0A0A0; color: #ffffff; padding:4px; border:#f0e0e0 1px solid;\n",
       "                font-weight: normal; font-family: monospace; font-size: 100%;\n",
       "            }\n",
       "            .Relation td{\n",
       "                padding:4px; border:#f0e0e0 1px solid; font-size:100%;\n",
       "            }\n",
       "            .Relation tr:nth-child(odd){\n",
       "                background: #ffffff;\n",
       "            }\n",
       "            .Relation tr:nth-child(even){\n",
       "                background: #f3f1ff;\n",
       "            }\n",
       "            /* Tooltip container */\n",
       "            .djtooltip {\n",
       "            }\n",
       "            /* Tooltip text */\n",
       "            .djtooltip .djtooltiptext {\n",
       "                visibility: hidden;\n",
       "                width: 120px;\n",
       "                background-color: black;\n",
       "                color: #fff;\n",
       "                text-align: center;\n",
       "                padding: 5px 0;\n",
       "                border-radius: 6px;\n",
       "                /* Position the tooltip text - see examples below! */\n",
       "                position: absolute;\n",
       "                z-index: 1;\n",
       "            }\n",
       "            #primary {\n",
       "                font-weight: bold;\n",
       "                color: black;\n",
       "            }\n",
       "\n",
       "            #nonprimary {\n",
       "                font-weight: normal;\n",
       "                color: white;\n",
       "            }\n",
       "\n",
       "            /* Show the tooltip text when you mouse over the tooltip container */\n",
       "            .djtooltip:hover .djtooltiptext {\n",
       "                visibility: visible;\n",
       "            }\n",
       "        </style>\n",
       "        \n",
       "        <b></b>\n",
       "            <div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "            <table border=\"1\" class=\"Relation\">\n",
       "                <thead> <tr style=\"text-align: right;\"> <th> <div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">subject_uuid</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"primary\">session_start_time</p>\n",
       "                                <span class=\"djtooltiptext\">start time</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">performance</p>\n",
       "                                <span class=\"djtooltiptext\">percentage correct in this session</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">performance_easy</p>\n",
       "                                <span class=\"djtooltiptext\">percentage correct of easy trials in this session</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">signed_contrasts</p>\n",
       "                                <span class=\"djtooltiptext\">contrasts used in this session, negative when on the left</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">n_trials_stim</p>\n",
       "                                <span class=\"djtooltiptext\">number of trials for each contrast</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">n_trials_stim_right</p>\n",
       "                                <span class=\"djtooltiptext\">number of reporting \"right\" trials for each contrast</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">prob_choose_right</p>\n",
       "                                <span class=\"djtooltiptext\">probability of choosing right, same size as contrasts</span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">threshold</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">bias</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">lapse_low</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div></th><th><div class=\"djtooltip\">\n",
       "                                <p id=\"nonprimary\">lapse_high</p>\n",
       "                                <span class=\"djtooltiptext\"></span>\n",
       "                            </div> </th> </tr> </thead>\n",
       "                <tbody> <tr> <td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-10 11:24:59</td>\n",
       "<td>0.367347</td>\n",
       "<td>0.367347</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>29.7063</td>\n",
       "<td>-58.2102</td>\n",
       "<td>0.823603</td>\n",
       "<td>0.409092</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-12 09:21:03</td>\n",
       "<td>0.4</td>\n",
       "<td>0.4</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>21.0607</td>\n",
       "<td>-58.2391</td>\n",
       "<td>0.609229</td>\n",
       "<td>0.181818</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-13 10:28:45</td>\n",
       "<td>0.408072</td>\n",
       "<td>0.408072</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>9.4945</td>\n",
       "<td>-0.13251</td>\n",
       "<td>0.684564</td>\n",
       "<td>0.364865</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-14 09:37:17</td>\n",
       "<td>0.4</td>\n",
       "<td>0.4</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>3.28746</td>\n",
       "<td>-67.9662</td>\n",
       "<td>0.772727</td>\n",
       "<td>0.454545</td></tr><tr><td>00778394-c956-408d-8a6c-ca3b05a611d5</td>\n",
       "<td>2019-08-14 11:35:16</td>\n",
       "<td>0.463668</td>\n",
       "<td>0.463668</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>=BLOB=</td>\n",
       "<td>10.4665</td>\n",
       "<td>99.3649</td>\n",
       "<td>0.72314</td>\n",
       "<td>0.0373897</td> </tr> </tbody>\n",
       "            </table>\n",
       "            <p>...</p>\n",
       "            <p>Total: 23408</p></div>\n",
       "            "
      ],
      "text/plain": [
       "*subject_uuid  *session_start performance    performance_ea signed_con n_trials_s n_trials_s prob_choos threshold     bias         lapse_low     lapse_high    \n",
       "+------------+ +------------+ +------------+ +------------+ +--------+ +--------+ +--------+ +--------+ +-----------+ +----------+ +-----------+ +------------+\n",
       "00778394-c956- 2019-08-10 11: 0.367347       0.367347       =BLOB=     =BLOB=     =BLOB=     =BLOB=     29.7063       -58.2102     0.823603      0.409092      \n",
       "00778394-c956- 2019-08-12 09: 0.4            0.4            =BLOB=     =BLOB=     =BLOB=     =BLOB=     21.0607       -58.2391     0.609229      0.181818      \n",
       "00778394-c956- 2019-08-13 10: 0.408072       0.408072       =BLOB=     =BLOB=     =BLOB=     =BLOB=     9.4945        -0.13251     0.684564      0.364865      \n",
       "00778394-c956- 2019-08-14 09: 0.4            0.4            =BLOB=     =BLOB=     =BLOB=     =BLOB=     3.28746       -67.9662     0.772727      0.454545      \n",
       "00778394-c956- 2019-08-14 11: 0.463668       0.463668       =BLOB=     =BLOB=     =BLOB=     =BLOB=     10.4665       99.3649      0.72314       0.0373897     \n",
       "   ...\n",
       " (Total: 23408)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from ibl_pipeline.analyses import behavior\n",
    "trials = behavior.PsychResults()\n",
    "trials"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's get the trial information for the first day KS022 trained. We will restrict the `Sessions` table by the day 1 eID and combine this with the `trials` table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>performance</th>\n",
       "      <th>performance_easy</th>\n",
       "      <th>signed_contrasts</th>\n",
       "      <th>n_trials_stim</th>\n",
       "      <th>n_trials_stim_right</th>\n",
       "      <th>prob_choose_right</th>\n",
       "      <th>threshold</th>\n",
       "      <th>bias</th>\n",
       "      <th>lapse_low</th>\n",
       "      <th>lapse_high</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>subject_uuid</th>\n",
       "      <th>session_start_time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>b57c1934-f9d1-4dc4-a474-e2cb4acdf918</th>\n",
       "      <th>2019-09-23 13:43:40</th>\n",
       "      <td>0.515432</td>\n",
       "      <td>0.515432</td>\n",
       "      <td>[-1.0, -0.5, 0.5, 1.0]</td>\n",
       "      <td>[81, 90, 73, 80]</td>\n",
       "      <td>[41, 51, 50, 38]</td>\n",
       "      <td>[0.5061728395061729, 0.5666666666666667, 0.684...</td>\n",
       "      <td>7.23087</td>\n",
       "      <td>86.8559</td>\n",
       "      <td>0.581967</td>\n",
       "      <td>0.525546</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                          performance  \\\n",
       "subject_uuid                         session_start_time                 \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40     0.515432   \n",
       "\n",
       "                                                          performance_easy  \\\n",
       "subject_uuid                         session_start_time                      \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40          0.515432   \n",
       "\n",
       "                                                                signed_contrasts  \\\n",
       "subject_uuid                         session_start_time                            \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40  [-1.0, -0.5, 0.5, 1.0]   \n",
       "\n",
       "                                                             n_trials_stim  \\\n",
       "subject_uuid                         session_start_time                      \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40  [81, 90, 73, 80]   \n",
       "\n",
       "                                                         n_trials_stim_right  \\\n",
       "subject_uuid                         session_start_time                        \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40    [41, 51, 50, 38]   \n",
       "\n",
       "                                                                                          prob_choose_right  \\\n",
       "subject_uuid                         session_start_time                                                       \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40  [0.5061728395061729, 0.5666666666666667, 0.684...   \n",
       "\n",
       "                                                          threshold     bias  \\\n",
       "subject_uuid                         session_start_time                        \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40    7.23087  86.8559   \n",
       "\n",
       "                                                          lapse_low  \\\n",
       "subject_uuid                         session_start_time               \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40   0.581967   \n",
       "\n",
       "                                                          lapse_high  \n",
       "subject_uuid                         session_start_time               \n",
       "b57c1934-f9d1-4dc4-a474-e2cb4acdf918 2019-09-23 13:43:40    0.525546  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "eid_day1 = dict(session_uuid=eids['session_uuid'][0])\n",
    "trials_day1 = ((sessions & eid_day1).proj() * trials).fetch(format='frame')\n",
    "trials_day1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice how a lot of the metrics that we manually computed from the trials dataset in the previous ONE tutorial have already been computed for us and are available in the `trials` table. This is one advantage of Datajoint, common computations such as performance can be computed when the data is ingested and stored in tables.\n",
    "\n",
    "We can find out which visual stimulus contrasts were presented to KS022 on day 1 and how many of each contrast by looking at the `signed_contrasts` and `n_trials_stim` attributes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Visual stimulus contrasts on day 1 = [-100.  -50.   50.  100.]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No. of each contrast on day 1 = [81 90 73 80]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "contrasts = trials_day1['signed_contrasts'].to_numpy()[0]\n",
    "n_contrasts = trials_day1['n_trials_stim'].to_numpy()[0]\n",
    "print(f\"Visual stimulus contrasts on day 1 = {contrasts * 100}\")\n",
    "print(f\"No. of each contrast on day 1 = {n_contrasts}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can easily extract the performance by typing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Correct = 51.5432 %"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "print(f\"Correct = { trials_day1['performance'].to_numpy()[0] * 100} %\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can plot the peformance at each contrast by looking at the `prob_choose_right` attribute. The results stored in Datajoint are already expressed in terms of rightward choice, so we don't need worry about converting any computations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.50617284 0.56666667 0.68493151 0.475     ]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "contrast_performance = trials_day1['prob_choose_right'].to_numpy()[0]\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "plt.plot(contrasts * 100, contrast_performance * 100, 'o-', lw=3, ms=10)\n",
    "plt.ylim([0, 100])\n",
    "plt.xticks([*(contrasts * 100)])\n",
    "plt.xlabel('Signed contrast (%)')\n",
    "plt.ylabel('Rightward choice (%)')\n",
    "\n",
    "print(contrast_performance)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's now repeat this for day 15 of training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Visual stimulus contrasts on day 1 = [-100.   -50.   -25.   -12.5   12.5   25.    50.   100. ]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No. of each contrast on day 1 = [ 94  65 107  16  21  75  78  64]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "eid_day15 = dict(session_uuid=eids['session_uuid'][14])\n",
    "trials_day15 = ((sessions & eid_day15).proj() * trials).fetch(format='frame')\n",
    "contrasts = trials_day15['signed_contrasts'].to_numpy()[0]\n",
    "n_contrasts = trials_day15['n_trials_stim'].to_numpy()[0]\n",
    "print(f\"Visual stimulus contrasts on day 1 = {contrasts * 100}\")\n",
    "print(f\"No. of each contrast on day 1 = {n_contrasts}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Correct = 88.2692 %"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "print(f\"Correct = { trials_day15['performance'].to_numpy()[0] * 100} %\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.09574468 0.12307692 0.22429907 0.1875     1.         0.93333333\n",
      " 0.91025641 0.921875  ]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "contrast_performance = trials_day15['prob_choose_right'].to_numpy()[0]\n",
    "\n",
    "plt.plot(contrasts * 100, contrast_performance * 100, 'o-', lw=3, ms=10)\n",
    "plt.ylim([0, 100])\n",
    "plt.xticks([*(contrasts * 100)])\n",
    "plt.xlabel('Signed contrast (%)')\n",
    "plt.ylabel('Rightward choice (%)')\n",
    "plt.xticks(rotation=90)\n",
    "\n",
    "print(contrast_performance)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "If we compare the results with the ONE tutorial, we will find that we have replicated those results using Datajoint, congratulations!\n",
    "\n",
    "You should now be comfortable with the basics of exploring the Datajoint IBL pipeline. More Datajoint tutorials can be found in the [IBL-Pipeline github](https://github.com/int-brain-lab/IBL-pipeline/tree/master/notebooks/notebooks_tutorial) or on the [Datajoint jupyter](https://jupyter.internationalbrainlab.org/)."
   ]
  }
 ],
 "metadata": {
  "docs_executed": "executed",
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
